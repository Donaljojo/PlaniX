{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">

    <h2>{{ project.name }} â€” Security Analysis Report</h2>
    <p class="text-muted">Generated on {{ analysis.created_at }}</p>

    <!-- EXECUTIVE SUMMARY -->
    <div class="card mb-3">
        <div class="card-header bg-primary text-white">
            <strong>Executive Summary</strong>
        </div>
        <div class="card-body">
            <pre style="white-space: pre-wrap;">{{ analysis.executive_summary }}</pre>
        </div>
    </div>

    <!-- SYSTEM ARCHITECTURE -->
    <div class="card mb-3">
        <div class="card-header"><strong>System Architecture</strong></div>
        <div class="card-body">
            <pre style="white-space: pre-wrap;">{{ analysis.architecture }}</pre>
        </div>
    </div>

    <!-- THREAT MODEL -->
    <div class="card mb-3">
        <div class="card-header"><strong>Threat Model</strong></div>
        <div class="card-body">
            <pre style="white-space: pre-wrap;">{{ analysis.threat_model }}</pre>
        </div>
    </div>

    <!-- SECURE SDLC -->
    <div class="card mb-3">
        <div class="card-header"><strong>Secure SDLC Recommendations</strong></div>
        <div class="card-body">
            <pre style="white-space: pre-wrap;">{{ analysis.sdls_recommendations }}</pre>
        </div>
    </div>

    <!-- COST ESTIMATION -->
    <div class="card mb-3">
        <div class="card-header"><strong>Cost Estimation</strong></div>
        <div class="card-body">
            <pre style="white-space: pre-wrap;">{{ analysis.cost_estimation }}</pre>
        </div>
    </div>

    <!-- SECURITY TESTING PLAN -->
    <div class="card mb-3">
        <div class="card-header"><strong>Security Testing Plan</strong></div>
        <div class="card-body">
            <pre style="white-space: pre-wrap;">{{ analysis.testing_plan }}</pre>
        </div>
    </div>

    <!-- RISK SCORE -->
    <div class="alert alert-info">
        <strong>Security Score:</strong> {{ analysis.security_score }}<br>
        <strong>Risk Category:</strong> {{ analysis.risk_category }}
    </div>

    <a href="{% url 'download_analysis_pdf' analysis.id %}" class="btn btn-success">Download PDF</a>
    <a href="{% url 'analysis_history' project.id %}" class="btn btn-info mt-2">
        View Analysis History
    </a>

    <a href="{% url 'dashboard' %}" class="btn btn-secondary mt-2">
        Back to Dashboard
    </a>


<a href="{% url 'export_analysis_md' analysis.id %}"
   class="btn btn-info mt-2">
    Download as Markdown
</a>

<a href="{% url 'export_analysis_txt' analysis.id %}"
   class="btn btn-dark mt-2">
    Download as Text
</a>
    <a href="{% url 'analysis_history' project.id %}" class="btn btn-secondary">Back</a>

</div>
{% endblock %}


